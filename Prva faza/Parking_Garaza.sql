CREATE TABLE PARKING_MESTO(
ID         number(15),
Sprat         number(15),
Status         varchar(15)
);

ALTER TABLE PARKING_MESTO ADD PRIMARY KEY(ID);

ALTER TABLE PARKING_MESTO ADD CONSTRAINT IDK_CHECK CHECK (Status IN ('Slobodno','Zauzeto')) ;

CREATE TABLE VOZILO(
Marka         varchar(15),
Tip         varchar(15),
Registarski_broj         varchar(9),
ID         number(15),
ID_Vlasnika         number(15) NOT NULL,
ID_Karte         number(15) NOT NULL
);

ALTER TABLE VOZILO ADD PRIMARY KEY(ID);

ALTER TABLE VOZILO ADD CONSTRAINT ID4_FK FOREIGN KEY(ID_Vlasnika) REFERENCES VLASNIK(ID);

ALTER TABLE VOZILO ADD CONSTRAINT ID5_FK FOREIGN KEY(ID_Karte) REFERENCES PRETPLATNA(ID);

CREATE TABLE KATEGORIJA(
ID               number(15),
Velicina_vozila         varchar(15),
ID_Parking_mesta         number(15) NOT NULL
);

ALTER TABLE KATEGORIJA ADD PRIMARY KEY(ID);

ALTER TABLE KATEGORIJA ADD CONSTRAINT ID1_FK FOREIGN KEY(ID_Parking_mesta) REFERENCES PARKING_MESTO(ID);

ALTER TABLE KATEGORIJA ADD CONSTRAINT IDK2_CHECK CHECK (Velicina_vozila IN ('A','B','C')) ;

CREATE TABLE SMENA(
Pocetak_smene         number,
Kraj_smene         number,
ID         number(15),
JMBG_Kontrolera        number(13),
JMBG_Operatera         number(13)
);

ALTER TABLE SMENA ADD PRIMARY KEY(ID);

ALTER TABLE SMENA ADD CONSTRAINT JMBG3_FK FOREIGN KEY(JMBG_Kontrolera) REFERENCES KONTROLER(JMBG);

ALTER TABLE SMENA ADD CONSTRAINT JMBG4_FK FOREIGN KEY(JMBG_Operatera) REFERENCES OPERATER(JMBG);

CREATE TABLE KONTROLER(
Vreme_rada         number(15),
JMBG         number(13)
);

ALTER TABLE KONTROLER ADD PRIMARY KEY(JMBG);

ALTER TABLE KONTROLER ADD CONSTRAINT JMBG_FK FOREIGN KEY(JMBG) REFERENCES OPERATER(JMBG);

CREATE TABLE OPERATER(
Datum_rodjenja         date,
JMBG         number(13),
Ime         varchar(15),
Prezime         varchar(15),
Datum_zaposlenja         date,
Radni_staz         number(15)
);

ALTER TABLE OPERATER ADD PRIMARY KEY(JMBG);

CREATE TABLE RFID_KARTICA(
ID         number(15),
JMBG_Operatera         number(13)
);

ALTER TABLE RFID_KARTICA ADD PRIMARY KEY(ID);

ALTER TABLE RFID_KARTICA ADD CONSTRAINT JMBG1_FK FOREIGN KEY(JMBG_Operatera) REFERENCES OPERATER(JMBG);

CREATE TABLE PRETPLATNA(
Rezervisano_mesto         varchar(15),
Vreme_vazenja_parkinga         number(15),
ID         number(15),
ID_Korisnika         number(15)
);

ALTER TABLE PRETPLATNA ADD PRIMARY KEY(ID);

ALTER TABLE PRETPLATNA ADD CONSTRAINT ID_FK FOREIGN KEY(ID) REFERENCES RFID_KARTICA(ID);

ALTER TABLE PRETPLATNA ADD CONSTRAINT ID3_FK FOREIGN KEY(ID_Korisnika) REFERENCES KORISNIK(ID);

CREATE TABLE POJEDINACNA(
Registarska_oznaka_vozila         varchar(9),
Vreme_izdavanja         timestamp,
Vreme_izlaska         timestamp,
ID         number(15),
ID_Parking_mesta         number(15)
);

ALTER TABLE POJEDINACNA ADD PRIMARY KEY(ID);

ALTER TABLE POJEDINACNA ADD CONSTRAINT ID_FK FOREIGN KEY(ID) REFERENCES RFID_KARTICA(ID);

ALTER TABLE POJEDINACNA ADD CONSTRAINT ID4_FK FOREIGN KEY(ID_Parking_mesta) REFERENCES PARKING_MESTO(ID);

CREATE TABLE KORISNIK(
JMBG         number(13),
ID         number(15)
);

ALTER TABLE KORISNIK ADD PRIMARY KEY(ID);

ALTER TABLE KORISNIK ADD CONSTRAINT ID_FK FOREIGN KEY(ID) REFERENCES OSOBA(ID);

CREATE TABLE VLASNIK(
ID         number(15)
);

ALTER TABLE VLASNIK ADD PRIMARY KEY(ID);

ALTER TABLE VLASNIK ADD CONSTRAINT ID_FK FOREIGN KEY(ID) REFERENCES OSOBA(ID);

CREATE TABLE OSOBA(
Ime         varchar(30),
Prezime         varchar(30),
ID         number(15)
);

ALTER TABLE OSOBA ADD PRIMARY KEY(ID);

CREATE SEQUENCE  "PARKING_MESTO_ID_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCYCLE ;

CREATE SEQUENCE  "RFID_KARTICA_ID_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCYCLE ;

CREATE SEQUENCE  "OSOBA_ID_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCYCLE ;

CREATE SEQUENCE  "SMENA_ID_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCYCLE ;

CREATE SEQUENCE  "KATEGORIJA_ID_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCYCLE ;

describe PARKING_MESTO;

INSERT INTO PARKING_MESTO
values(1,2,'Slobodno');

INSERT INTO PARKING_MESTO
values(2,1,'Slobodno');

INSERT INTO PARKING_MESTO
values(3,1,'Slobodno');

INSERT INTO PARKING_MESTO
values(4,2,'Slobodno');

INSERT INTO PARKING_MESTO
values(5,3,'Slobodno');

describe KATEGORIJA;

INSERT INTO KATEGORIJA
values(1,'A',2);

INSERT INTO KATEGORIJA
values(2,'B',4);

INSERT INTO KATEGORIJA
values(3,'C',1);

INSERT INTO KATEGORIJA
values(4,'B',5);

INSERT INTO KATEGORIJA
values(5,'C',3);

describe OPERATER;

INSERT INTO OPERATER
values(TO_DATE('08/10/1989', 'DD/MM/YYYY'),1234086501928,'Petar','Petrovic',TO_DATE('11/05/2014', 'DD/MM/YYYY'),9);

INSERT INTO OPERATER
values(TO_DATE('06/03/1999', 'DD/MM/YYYY'),0603417400467,'Bogdan','Bogdanovic',TO_DATE('22/04/2019', 'DD/MM/YYYY'),4);

INSERT INTO OPERATER
values(TO_DATE('18/02/1981', 'DD/MM/YYYY'),1802031409170,'Aleksa','Aleksic',TO_DATE('09/07/2011', 'DD/MM/YYYY'),12);

INSERT INTO OPERATER
values(TO_DATE('24/09/1977', 'DD/MM/YYYY'),2409201740086,'Milos','Milosevic',TO_DATE('28/08/2012', 'DD/MM/YYYY'),11);

INSERT INTO OPERATER
values(TO_DATE('13/04/1994', 'DD/MM/YYYY'),1304451740981,'Marko','Milakovic',TO_DATE('11/05/2017', 'DD/MM/YYYY'),6);

describe KONTROLER;

INSERT INTO KONTROLER
values(8,1304451740981);

INSERT INTO KONTROLER
values(6,1234086501928);

INSERT INTO KONTROLER
values(10,0603417400467);

INSERT INTO KONTROLER
values(8,1802031409170);

INSERT INTO KONTROLER
values(7,2409201740086);

describe SMENA;

INSERT INTO SMENA
values(6,14,1,1802031409170,1802031409170);

INSERT INTO SMENA
values(14,22,2,0603417400467,0603417400467);

INSERT INTO SMENA
values(22,6,3,2409201740086,2409201740086);

INSERT INTO SMENA
values(14,22,4,1234086501928,1234086501928);

INSERT INTO SMENA
values(6,14,5,1304451740981,1304451740981);

describe RFID_KARTICA;

INSERT INTO RFID_KARTICA
values(1,1234086501928);

INSERT INTO RFID_KARTICA
values(2,1234086501928);

INSERT INTO RFID_KARTICA
values(3,1304451740981);

INSERT INTO RFID_KARTICA
values(4,0603417400467);

INSERT INTO RFID_KARTICA
values(5,2409201740086);

describe KORISNIK;

INSERT INTO OSOBA
values('Pavle','Pavlovic',1);

INSERT INTO OSOBA
values('Marko','Markovic',2);

INSERT INTO OSOBA
values('Milos','Milosevic',3);

INSERT INTO OSOBA
values('Dusan','Pavicevic',4);

INSERT INTO OSOBA
values('Jovan','Jovanovic',5);

INSERT INTO KORISNIK
values(1095749038715,1);

INSERT INTO KORISNIK
values(4980215017404,2);

INSERT INTO KORISNIK
values(1059402917482,3);

INSERT INTO KORISNIK
values(2084181740021,4);

INSERT INTO KORISNIK
values(2950178217400,5);

INSERT INTO VLASNIK
values(1);

INSERT INTO VLASNIK
values(2);

INSERT INTO VLASNIK
values(3);

INSERT INTO VLASNIK
values(4);

INSERT INTO VLASNIK
values(5);

describe PRETPLATNA;

INSERT INTO PRETPLATNA
values('A1',8,1,1);

INSERT INTO PRETPLATNA
values('A8',3,2,3);

INSERT INTO PRETPLATNA
values('B12',4,3,4);

INSERT INTO PRETPLATNA
values('C4',2,4,2);

INSERT INTO PRETPLATNA
values('D2',12,5,5);

describe VOZILO;

INSERT INTO VOZILO
values('AUDI','Limuzina','BG-067-MG',1,1,1);

INSERT INTO VOZILO
values('BMW','Limuzina','NI-033-DB',2,2,2);

INSERT INTO VOZILO
values('Nissan','Suv','NI-128-BU',3,3,3);

INSERT INTO VOZILO
values('Mercedes','Limuzina','BG-361-DD',4,4,4);

INSERT INTO VOZILO
values('BMW','Kupe','NI-011-GC',5,5,5);

describe POJEDINACNA;

INSERT INTO POJEDINACNA
values('BG-067-MG',TO_DATE('05/04/2023 14:30','DD/MM/YYYY HH24:MI'),TO_DATE('05/04/2023 17:30','DD/MM/YYYY HH24:MI'),1,1);

INSERT INTO POJEDINACNA
values('BG-361-DD',TO_DATE('04/04/2023 12:30','DD/MM/YYYY HH24:MI'),TO_DATE('05/04/2023 09:25','DD/MM/YYYY HH24:MI'),2,2);

INSERT INTO POJEDINACNA
values('NI-033-DB',TO_DATE('08/04/2023 18:30','DD/MM/YYYY HH24:MI'),TO_DATE('08/04/2023 20:15','DD/MM/YYYY HH24:MI'),3,3);

INSERT INTO POJEDINACNA
values('NI-128-BU',TO_DATE('02/04/2023 20:30','DD/MM/YYYY HH24:MI'),TO_DATE('07/04/2023 15:00','DD/MM/YYYY HH24:MI'),4,4);

INSERT INTO POJEDINACNA
values('NI-011-GC',TO_DATE('03/04/2023 09:00','DD/MM/YYYY HH24:MI'),TO_DATE('05/04/2023 07:30','DD/MM/YYYY HH24:MI'),5,5);

CREATE OR REPLACE TRIGGER "PARKING_MESTO_PK" 
    BEFORE INSERT
    ON PARKING_MESTO
    REFERENCING NEW AS NEW
    FOR EACH ROW
BEGIN
    SELECT PARKING_MESTO_ID_SEQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;
/
ALTER TRIGGER "PARKING_MESTO_PK" ENABLE;

CREATE OR REPLACE TRIGGER "RFID_KARTICA_PK" 
    BEFORE INSERT
    ON RFID_KARTICA
    REFERENCING NEW AS NEW
    FOR EACH ROW
BEGIN
    SELECT RFID_KARTICA_ID_SEQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;
/
ALTER TRIGGER "RFID_KARTICA_PK" ENABLE;

CREATE OR REPLACE TRIGGER "OSOBA_PK" 
    BEFORE INSERT
    ON OSOBA
    REFERENCING NEW AS NEW
    FOR EACH ROW
BEGIN
    SELECT OSOBA_ID_SEQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;
/
ALTER TRIGGER "OSOBA_PK" ENABLE;

CREATE OR REPLACE TRIGGER "SMENA_PK" 
    BEFORE INSERT
    ON SMENA
    REFERENCING NEW AS NEW
    FOR EACH ROW
BEGIN
    SELECT SMENA_ID_SEQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;
/
ALTER TRIGGER "SMENA_PK" ENABLE;

CREATE OR REPLACE TRIGGER "KATEGORIJA_PK" 
    BEFORE INSERT
    ON KATEGORIJA
    REFERENCING NEW AS NEW
    FOR EACH ROW
BEGIN
    SELECT KATEGORIJA_ID_SEQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;
/
ALTER TRIGGER "KATEGORIJA_PK" ENABLE;